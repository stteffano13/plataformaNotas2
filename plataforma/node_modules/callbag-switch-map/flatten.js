const fromEvent = require('callbag-from-event');
const interval = require('callbag-interval');
const flatten = require('callbag-flatten');

const fromPromise = require('callbag-from-promise');
const forEach = require('callbag-for-each');
const pipe = require('callbag-pipe');
const map = require('callbag-map');


const fakeAjax = value => new Promise((resolve, reject) =>{
	let period = value % 2 ? 400 : 1200; 
	setTimeout(resolve, period, (value * value));
});

const source = pipe(
  interval(500),
  map(i => fromPromise(fakeAjax(i))),
  flatten,
  forEach(x => console.log(x))
);

